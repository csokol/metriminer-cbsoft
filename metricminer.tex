\documentclass[12pt]{article}

\usepackage{sbc-template}

\usepackage{url}
\usepackage[pdftex]{graphicx}           % usamos arquivos pdf/png como figuras

\usepackage[brazil]{babel}   
\usepackage[latin1]{inputenc}  
     
\sloppy

\title{MetricMiner: uma ferramenta web de apoio à mineração de repositórios de software}

\author{Francisco Zigmund Sokol\inst{1}, Mauricio Aniche\inst{1}, Marco Aurélio Gerosa\inst{1}}


\address{Instituto de Matemática e Estatística -- Universidade de São Paulo
  (USP)\\
  Rua do Matão, 1010 -- 05508-090 -- São Paulo -- SP -- Brasil
  \email{chico.sokol@gmail.com, aniche@ime.usp.br, gerosa@ime.usp.br}
}

\begin{document} 

\maketitle

\begin{abstract}    
\end{abstract}
     
\begin{resumo} 
    Este trabalho apresenta uma ferramenta web que oferece suporte ao 
    pesquisador da área de mineração de repositórios de software, o MetricMiner.
    Essa ferramenta armazena diversas informações de repositórios e calcula 
    métricas de código fonte sobre todo o histórico dos projetos a partir
    dos seus sistemas de controle de versões.
    Utilizando os softwares disponíveis atualmente, o pesquisador precisa configurar 
    a ferramenta localmente e baixar os projetos sobre os quais deseja calcular
    suas métricas em um processo difícil, caro e demorado.
    Com o MetricMiner, toda a interação é feita por meio de uma interface web, tornando
    o processo de pesquisa mais eficiente.
    Além disso, o sistema disponibiliza uma base com dados de uma série de projetos 
    de código aberto sobre os quais um pesquisador pode extrair e relacionar 
    informações, além de submeter novas métricas para serem calculadas para
    esses projetos.
\end{resumo}

\section{Motivação} % descrição e motivação do problema tratado pela ferramenta;

Minerar repositórios de software é uma tarefa custosa. Para desenvolver uma 
pesquisa na área, o pesquisador é obrigado a baixar diversos projetos
em sua estação de trabalho, realizar uma série de cálculos sobre o código
dos projetos e sobre os meta dados de seu repositório. Esse processo requer que
o pesquisador instale diversos softwares e bibliotecas localmente para reaproveitar
as ferramentas desenvolvidas nessa área, em um processo difícil e demorado.

Além de ser um processo complexo, esse tipo de pesquisa consome muitos recursos 
computacionais. Baixar os repositórios a serem minerados consome um 
volume considerável de banda. Depois, os dados devem ser processados e 
persistidos em um banco de dados, ocupando uma grande volume de disco.
Só então o pesquisador pode calcular métricas sobre esses dados, além de 
extrair relações entre os meta dados do histórico do sistema de controle de versão,
gastando uma quantidade grande de processamento de CPU. Só depois de passar por todas
essas etapas, é possível extrair dados e validar hipóteses através de análises estatísticas.

A partir dessas dificuldades, surgiu a motivação para o desenvolvimento do MetricMiner,
uma aplicação web que realiza todas as etapas custosas da mineração de um repositório
de software. 

% - comentar recursos gastos minerando localmente, disco, rede, processamento e o tempo que demora para completar todas as etapas
% - comentar escalabilidade, cloud etc etc, escalar verticalmente facilmente

\section{Arquitetura} % arquitetura de solução da ferramenta;

Para o desenvolvimento da aplicação web, foi utilizado o VRaptor, um arcabouço para desenvolvimento web
em Java baseado no padrão de projeto MVC (Model-View-Controller). Para a armazenar os dados minerados
foi utilizado o banco de dados MySQL e o ORM Hibernate. %(ref mvc, vraptor, hibernate)

O MetricMiner surgiu a partir do rEvolution, uma ferramenta de linha de comando que extrai dados
de um repositório local e persiste em banco de dados relacional. Com isso, o componente que faz a interface
com o sistema de controle de versões pôde ser reutilizado no MetricMiner. Esse componente é bastante flexível em 
relação ao sistema de controle de versão utilizado pelo projeto que será minerado. Para suportar um novo sistema
de controle de versão é necessário apenas a implementação da intreface org.metricminer.SCM, que contém 
operações básicas sobre os metadados do sistema de controle de versão. Até o momento, apenas o git possui suporte 
na ferramenta. %(referencias git, revolution)

O MetricMiner se baseia na simulação de uma fila de execução para completar tarefas demoradas, como baixar
repositórios, persistir suas informações no banco de dados e calcular métricas sobre o código fonte. 
Para isso, o componente que processa a fila de execução, extrai as informações da tarefa do banco de
dados, constrói os objetos necessários para a execução da tarefa e a executa. A arquitetura é bastante
flexível nesse ponto, de forma que para a definição de uma nova tarefa é necessário apenas que sejam desenvolvidas
duas classes que implementam as interfaces org.metricminer.RunnableTask e org.metricminer.RunnableTaskFactory.

Cada tarefa implementada tem acesso ao projeto sobre o qual a tarefa será executada e uma conexão com o 
banco de dados. Dessa forma, cada tarefa pode extrair e relacionar qualquer informação do projeto e persistir
os seus resultados no banco de dados.

A arquitetura também é flexível em relação a criação de novas métricas de código. Para criar uma nova métrica, deve ser
definida uma classe para representar os resultados do cálculo da métrica que serão armazenados no banco de dados
e uma classe que implemente a interface org.metricminer.tasks.metric.common.Metric. O cálculo das métricas
sobre o código dos projetos cadastrados é feito através da tarefa definida na classe org.metricminer.CalculateMetricTask.
Ao ser executada na fila de execução, essa tarefa calcula uma determinada métrica para todas as versões de todos os 
códigos fonte de um projeto. Até o momento já foram implementadas as métricas: 
\begin{itemize} %(referencias métricas com aniche)
    \item Complexidade Ciclomática
    \item Falta de Coesão dos Métodos (LCOM)
    \item Fan-out
    \item Quantidade de Linhas de Código (LOC) 
    \item Quantidade de Invocações de Métodos
\end{itemize}
    
% - explicar o processo: cadastrar projeto, cadastrar tarefas, executar tarefas
% - explicar arquitetura do TaskRunner e como plugar novas tasks
% - explicar a arquitetura do CalculateMetricTask e como plugar novas métricas nele

\section{Principais funcionalidades} % descrição das principais funcionalidades;
    Para cadastrar um projeto, o usuário deve fornecer o nome e a url do repositório do código do projeto. Depois de salvar,
    são inseridas novas tarefas na fila de execução que irão baixar o código do respositório e persistir os dados
    do sistema de controle de versão do projeto no banco de dados. Ao final dessas tarefas, o usuário pode entrar na tela de detalhes
    do projeto cadastrado e vizualizar alguns dados simples do projeto cadastrado.
        
    A figura \ref{fig:screen_projeto} mostra a tela de vizualização no MetricMiner do projeto Ant, software de código aberto da fundação 
    Apache com mais seis mil commits. Nesta tela, são exibidas informações básicas sobre o projeto como número de commits,
    número de commiters, url do repositório, data do primeiro e último commit. São exibidos também dois gráficos simples 
    nos quais pode ser vizualizado o número de commits nos últimos doze meses e o número de arquivos modificados em cada 
    commit nos últimos seis meses.
    
    Mais abaixo, na seção "Avaiable Metrics to Calculate", são exibidas as métricas disponíveis no MetricMiner e que ainda não
    foram calculadas para o projeto. O usuário pode selecionar as métricas que deseja calcular e as tarefas para a realizaçao dos
    cálculos serão inseridas à fila de execução. Na seção "Scheduled Tasks", as tarefas que já foram executadas podem ser
    vizualizadas. Nesse caso, podemos ver que as métricas de complexidade ciclomática e a fan-out já foram calculadas, 
    enquanto a LCOM e a quantidade de invocações de métodos estão na fila de execução para serem calculadas.
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=0.95\textwidth]{img/projeto.png}
    \caption{Tela de vizualização de projeto}
    \label{fig:screen_projeto}
    \end{figure}

    Após o cálculo das métricas, o pesquisador pode realizar consultas aos dados calculados pela ferramenta. A figura 
    \ref{fig:screen_query} exibe a tela na qual é possível inserir uma consulta em SQL ao banco de dados do MetriMiner.
    Depois de salvar a query, uma nova tarefa é adicionada à fila de execução e, ao final dessa tarefa, o pesquisador
    pode baixar o resultado de sua métrica em um arquivo CSV (Comma Separated Values).
    
    
    \begin{figure}[ht]
    \centering
    \includegraphics[width=0.95\textwidth]{img/query.png}
    \caption{Tela de consultas aos dados calculados}
    \label{fig:screen_query}
    \end{figure}
%     SELECT result.* , a.*, c.date FROM LinesOfCodeResult AS result
%     JOIN SourceCode s ON s.id=result.sourceCode_id 
%     JOIN Artifact a ON a.id=s.artifact_id
%     JOIN Commit_Artifact ca ON ca.artifacts_id=a.id
%     JOIN Commit c ON c.id=ca.commits_id;


\section{Outras ferramentas} %breve comparação com outras ferramentas relacionadas existentes;


\section{Referências}

\bibliographystyle{sbc}
\bibliography{sbc-template}

\end{document}
